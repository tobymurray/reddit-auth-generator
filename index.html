<!DOCTYPE html>
<html>

<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
  <meta content="utf-8" http-equiv="encoding">
  <link rel="stylesheet" type="text/css" href="main.css">
  <script>
    function validate() {
      var clientId = document.getElementById('clientId').value;
      var responseType = document.getElementById('responseType').value;
      var state = document.getElementById('state').value;
      var redirectUri = document.getElementById('redirectUri').value;
      var duration = document.getElementById('duration').value;
      var scopes = document.getElementById('scopes').value;

      var link = document.getElementById('outputHref');
      link.setAttribute('href', `https://www.reddit.com/api/v1/authorize?client_id=${clientId}&response_type=${responseType}&state=${state}&redirect_uri=${redirectUri}&duration=${duration}&scope=${scopes}`);
      return false;
    }
    function init() {
      document.getElementById('form').onsubmit = validate;
    }
    window.onload = init;
  </script>

  <script>
    function createTagSpan(scope) {

    }
    function myCallback(data) {
      var allSpans = [];
      for (const scope in data) {
        var input = document.createElement('input');
        input.type = 'checkbox';
        input.id = data[scope].id;
        input.name = data[scope].id;

        var label = document.createElement('label');
        label.for = data[scope].id;
        label.appendChild(input)

        label.appendChild(document.createTextNode(data[scope].name))

        allSpans.push(label);
        allSpans.push(document.createElement('br'));
      }

      window.addEventListener('load', event => {
        allSpans.forEach(span => document.getElementById('checkboxContainer').appendChild(span));
      });
    }
  </script>
  <script src="https://jsonp.afeld.me/?callback=myCallback&url=https://www.reddit.com/api/v1/scopes"></script>


</head>

<body>

  <div id="container">
    <!-- flex container -->

    <div class="box" id="bluebox">
      <!-- flex item -->
      <h1>Generate Reddit auth string</h1>

      <form id="form">
        <label for="clientId">Client ID:</label><br>
        <input type="text" id="clientId" name="clientId"><br>

        <label for="clienresponseTypetId">Response Type:</label><br>
        <input type="text" id="responseType" name="responseType"><br>

        <label for="state">State:</label><br>
        <input type="text" id="state" name="state"><br>

        <label for="redirectUri">Redirect URI:</label><br>
        <input type="text" id="redirectUri" name="redirectUri" value="https://www.reddit.com/prefs/apps"><br>

        <label for="duration">Duration:</label><br>
        <select name="duration" id="duration" value="temporary">
          <option value="temporary">Temporary</option>
          <option value="permanent">Permanent</option>
        </select> <br>

        <input type="submit" value="Submit">
      </form>
      <a id="outputHref" href="">Link</a>

    </div>
    <div class="box" id="checkboxContainer">
      <h2>Scopes</h2>
    </div>
  </div>

</body>

</html>